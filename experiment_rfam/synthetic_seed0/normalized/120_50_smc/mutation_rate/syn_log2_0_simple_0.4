#####Stage 3#####
Here is the configuration of this run: 
Munch({'exp_name': 'performance on short sequences', 'conserved': False, 'gpu': '0,1,2,3', 'u_net_d': 10, 'BATCH_SIZE': 8, 'batch_size_stage_1': 20, 'batch_size_stage_2': 16, 'OUT_STEP': 100, 'LOAD_MODEL': True, 'pp_steps': 20, 'pp_loss': 'f1', 'pp_model': 'mixed', 'rho_per_position': 'matrix', 'data_type': 'Rfam_14.5_synthetic_600', 'model_type': 'att_simple_fix', 'epoches_first': 50, 'epoches_second': 10, 'epoches_third': 10, 'evaluate_epi': 1, 'evaluate_epi_stage_1': 5, 'step_gamma': 1, 'k': 1, 'test': Munch({'f1': True, 'accuracy': False, 'energy': False})})
Max seq length  600
Loading u net model...
Stage 3, epoch 0, step: 0, loss_u: 0.6848639845848083, loss_a: 0.6211053729057312, loss: 1.3059693574905396
Average training F1 score:  0.49036702038896945
Stage 3, epoch 0, step: 100, loss_u: 0.6878798604011536, loss_a: 0.6420285701751709, loss: 1.3299083709716797
Average training F1 score:  0.4386880260409909
Stage 3, epoch 0, step: 200, loss_u: 0.6875269412994385, loss_a: 0.512854278087616, loss: 1.2003812789916992
Average training F1 score:  0.5266311628947618
Stage 3, epoch 0, step: 300, loss_u: 0.6957497596740723, loss_a: 0.7362492084503174, loss: 1.4319989681243896
Average training F1 score:  0.2821514046526376
Stage 3, epoch 0, step: 400, loss_u: 0.687054455280304, loss_a: 0.5420352816581726, loss: 1.2290897369384766
Average training F1 score:  0.481062868221125
Stage 3, epoch 0, step: 500, loss_u: 0.6909722089767456, loss_a: 0.6421157717704773, loss: 1.3330879211425781
Average training F1 score:  0.39395490846795134
Average validation F1 score with learning post-processing:  0.52266234
Average validation F1 score with learning post-processing allow shift:  0.5887392
Average validation precision with learning post-processing:  0.42412734
Average validation precision with learning post-processing allow shift:  0.47901663
Average validation recall with learning post-processing:  0.7210795
Average validation recall with learning post-processing allow shift:  0.8104887
Stage 3, epoch 1, step: 600, loss_u: 0.678761899471283, loss_a: 0.552908182144165, loss: 1.2316701412200928
Average training F1 score:  0.5030163050467664
Stage 3, epoch 1, step: 700, loss_u: 0.6836970448493958, loss_a: 0.6511804461479187, loss: 1.3348774909973145
Average training F1 score:  0.40052808558103814
Stage 3, epoch 1, step: 800, loss_u: 0.6873664855957031, loss_a: 0.3976624310016632, loss: 1.085028886795044
Average training F1 score:  0.6495046488661984
Stage 3, epoch 1, step: 900, loss_u: 0.6798193454742432, loss_a: 0.5293161273002625, loss: 1.2091355323791504
Average training F1 score:  0.5267806375760488
Stage 3, epoch 1, step: 1000, loss_u: 0.6866019368171692, loss_a: 0.6408806443214417, loss: 1.3274825811386108
Average training F1 score:  0.3878842398912513
Stage 3, epoch 1, step: 1100, loss_u: 0.6911121606826782, loss_a: 0.5257776379585266, loss: 1.2168898582458496
Average training F1 score:  0.5138987752194779
Average validation F1 score with learning post-processing:  0.5368884
Average validation F1 score with learning post-processing allow shift:  0.6055077
Average validation precision with learning post-processing:  0.44198045
Average validation precision with learning post-processing allow shift:  0.5007231
Average validation recall with learning post-processing:  0.7278225
Average validation recall with learning post-processing allow shift:  0.81754863
Stage 3, epoch 2, step: 1200, loss_u: 0.6855719089508057, loss_a: 0.5673957467079163, loss: 1.2529675960540771
Average training F1 score:  0.48498915409469323
Stage 3, epoch 2, step: 1300, loss_u: 0.6814162135124207, loss_a: 0.545113205909729, loss: 1.2265293598175049
Average training F1 score:  0.4949032909212131
Stage 3, epoch 2, step: 1400, loss_u: 0.679376482963562, loss_a: 0.5156093835830688, loss: 1.1949858665466309
Average training F1 score:  0.523220400881462
Stage 3, epoch 2, step: 1500, loss_u: 0.6798334121704102, loss_a: 0.498460590839386, loss: 1.1782939434051514
Average training F1 score:  0.5692939136935319
Stage 3, epoch 2, step: 1600, loss_u: 0.6794660091400146, loss_a: 0.5235458016395569, loss: 1.2030117511749268
Average training F1 score:  0.5229195218868197
Stage 3, epoch 2, step: 1700, loss_u: 0.6847266554832458, loss_a: 0.4891727864742279, loss: 1.1738994121551514
Average training F1 score:  0.5716377075353906
Average validation F1 score with learning post-processing:  0.5498936
Average validation F1 score with learning post-processing allow shift:  0.60437185
Average validation precision with learning post-processing:  0.44230694
Average validation precision with learning post-processing allow shift:  0.48813558
Average validation recall with learning post-processing:  0.7775149
Average validation recall with learning post-processing allow shift:  0.8531661
Stage 3, epoch 3, step: 1800, loss_u: 0.6806620955467224, loss_a: 0.5148048400878906, loss: 1.1954669952392578
Average training F1 score:  0.5479331858801255
Stage 3, epoch 3, step: 1900, loss_u: 0.6919717192649841, loss_a: 0.5420755743980408, loss: 1.234047293663025
Average training F1 score:  0.5055812562258509
Stage 3, epoch 3, step: 2000, loss_u: 0.6899236440658569, loss_a: 0.361945778131485, loss: 1.0518693923950195
Average training F1 score:  0.6843658627507312
Stage 3, epoch 3, step: 2100, loss_u: 0.6780508756637573, loss_a: 0.5319544076919556, loss: 1.210005283355713
Average training F1 score:  0.5318501819841245
Stage 3, epoch 3, step: 2200, loss_u: 0.6872286200523376, loss_a: 0.4621759057044983, loss: 1.149404525756836
Average training F1 score:  0.6063028104930333
Stage 3, epoch 3, step: 2300, loss_u: 0.6784110069274902, loss_a: 0.5552273988723755, loss: 1.2336384057998657
Average training F1 score:  0.5278428679163973
Average validation F1 score with learning post-processing:  0.557033
Average validation F1 score with learning post-processing allow shift:  0.62556887
Average validation precision with learning post-processing:  0.47332993
Average validation precision with learning post-processing allow shift:  0.53434855
Average validation recall with learning post-processing:  0.71904075
Average validation recall with learning post-processing allow shift:  0.80414885
Stage 3, epoch 4, step: 2400, loss_u: 0.6725127100944519, loss_a: 0.5001785159111023, loss: 1.1726912260055542
Average training F1 score:  0.5668301541385921
Stage 3, epoch 4, step: 2500, loss_u: 0.707936704158783, loss_a: 0.4692964553833008, loss: 1.1772332191467285
Average training F1 score:  0.5771977918437532
Stage 3, epoch 4, step: 2600, loss_u: 0.6861712336540222, loss_a: 0.41123953461647034, loss: 1.097410798072815
Average training F1 score:  0.6244332686716678
Stage 3, epoch 4, step: 2700, loss_u: 0.6866495609283447, loss_a: 0.48474666476249695, loss: 1.171396255493164
Average training F1 score:  0.5653003224217616
Stage 3, epoch 4, step: 2800, loss_u: 0.6821897625923157, loss_a: 0.4700925946235657, loss: 1.1522823572158813
Average training F1 score:  0.5725745980861459
Stage 3, epoch 4, step: 2900, loss_u: 0.6887933015823364, loss_a: 0.5554749369621277, loss: 1.2442681789398193
Average training F1 score:  0.4812421809324391
Average validation F1 score with learning post-processing:  0.56962025
Average validation F1 score with learning post-processing allow shift:  0.6303243
Average validation precision with learning post-processing:  0.48217523
Average validation precision with learning post-processing allow shift:  0.5365439
Average validation recall with learning post-processing:  0.7414507
Average validation recall with learning post-processing allow shift:  0.8185136
Stage 3, epoch 5, step: 3000, loss_u: 0.6851627826690674, loss_a: 0.45461249351501465, loss: 1.139775276184082
Average training F1 score:  0.5906472599919224
Stage 3, epoch 5, step: 3100, loss_u: 0.6871020197868347, loss_a: 0.41008105874061584, loss: 1.097183108329773
Average training F1 score:  0.6412973946975794
Stage 3, epoch 5, step: 3200, loss_u: 0.6908881664276123, loss_a: 0.4204321503639221, loss: 1.1113202571868896
Average training F1 score:  0.6247833799423399
Stage 3, epoch 5, step: 3300, loss_u: 0.6781282424926758, loss_a: 0.4150874614715576, loss: 1.0932157039642334
Average training F1 score:  0.6501081702903477
Stage 3, epoch 5, step: 3400, loss_u: 0.680321991443634, loss_a: 0.45851442217826843, loss: 1.13883638381958
Average training F1 score:  0.6046115348065556
Stage 3, epoch 5, step: 3500, loss_u: 0.6889994144439697, loss_a: 0.36437997221946716, loss: 1.0533794164657593
Average training F1 score:  0.6679359053380893
Average validation F1 score with learning post-processing:  0.57582474
Average validation F1 score with learning post-processing allow shift:  0.6354637
Average validation precision with learning post-processing:  0.4869308
Average validation precision with learning post-processing allow shift:  0.53981555
Average validation recall with learning post-processing:  0.7496409
Average validation recall with learning post-processing allow shift:  0.823878
Stage 3, epoch 6, step: 3600, loss_u: 0.6863459348678589, loss_a: 0.41984185576438904, loss: 1.1061878204345703
Average training F1 score:  0.6175556743392109
Stage 3, epoch 6, step: 3700, loss_u: 0.6838749051094055, loss_a: 0.5100166201591492, loss: 1.1938915252685547
Average training F1 score:  0.5431404831401954
Stage 3, epoch 6, step: 3800, loss_u: 0.6835922002792358, loss_a: 0.4621478021144867, loss: 1.145740032196045
Average training F1 score:  0.6032876406323622
Stage 3, epoch 6, step: 3900, loss_u: 0.686918318271637, loss_a: 0.6128988265991211, loss: 1.2998170852661133
Average training F1 score:  0.4243923611111111
Stage 3, epoch 6, step: 4000, loss_u: 0.6901026964187622, loss_a: 0.5369609594345093, loss: 1.2270636558532715
Average training F1 score:  0.5175066077229349
Stage 3, epoch 6, step: 4100, loss_u: 0.6858082413673401, loss_a: 0.3733038902282715, loss: 1.0591120719909668
Average training F1 score:  0.6696991699337389
Average validation F1 score with learning post-processing:  0.57823515
Average validation F1 score with learning post-processing allow shift:  0.64364827
Average validation precision with learning post-processing:  0.5011239
Average validation precision with learning post-processing allow shift:  0.5600228
Average validation recall with learning post-processing:  0.7244222
Average validation recall with learning post-processing allow shift:  0.80374897
Stage 3, epoch 7, step: 4200, loss_u: 0.6867086887359619, loss_a: 0.4579625129699707, loss: 1.1446712017059326
Average training F1 score:  0.5742550724374802
Stage 3, epoch 7, step: 4300, loss_u: 0.685339093208313, loss_a: 0.4254586696624756, loss: 1.1107977628707886
Average training F1 score:  0.621101984787235
Stage 3, epoch 7, step: 4400, loss_u: 0.6806992888450623, loss_a: 0.40397676825523376, loss: 1.0846760272979736
Average training F1 score:  0.6639692051696529
Stage 3, epoch 7, step: 4500, loss_u: 0.6865664720535278, loss_a: 0.4242534339427948, loss: 1.110819935798645
Average training F1 score:  0.6244279741963865
Stage 3, epoch 7, step: 4600, loss_u: 0.6866941452026367, loss_a: 0.49693170189857483, loss: 1.1836258172988892
Average training F1 score:  0.5459528817554153
Stage 3, epoch 7, step: 4700, loss_u: 0.6817847490310669, loss_a: 0.4754559099674225, loss: 1.157240629196167
Average training F1 score:  0.5851822460693428
Average validation F1 score with learning post-processing:  0.5805118
Average validation F1 score with learning post-processing allow shift:  0.6467109
Average validation precision with learning post-processing:  0.5006957
Average validation precision with learning post-processing allow shift:  0.5621497
Average validation recall with learning post-processing:  0.7322885
Average validation recall with learning post-processing allow shift:  0.81216866
Stage 3, epoch 8, step: 4800, loss_u: 0.6750251650810242, loss_a: 0.5348240733146667, loss: 1.209849238395691
Average training F1 score:  0.5201198814278386
Stage 3, epoch 8, step: 4900, loss_u: 0.6851935982704163, loss_a: 0.4217420518398285, loss: 1.1069356203079224
Average training F1 score:  0.6304578907034513
Stage 3, epoch 8, step: 5000, loss_u: 0.6740904450416565, loss_a: 0.4747304916381836, loss: 1.1488208770751953
Average training F1 score:  0.5630295054494621
Stage 3, epoch 8, step: 5100, loss_u: 0.6851592659950256, loss_a: 0.5199950933456421, loss: 1.2051544189453125
Average training F1 score:  0.5321956926108052
Stage 3, epoch 8, step: 5200, loss_u: 0.6868355870246887, loss_a: 0.5731181502342224, loss: 1.2599537372589111
Average training F1 score:  0.47957825495397766
Stage 3, epoch 8, step: 5300, loss_u: 0.6800001859664917, loss_a: 0.3542400300502777, loss: 1.0342402458190918
Average training F1 score:  0.7029641998425337
Average validation F1 score with learning post-processing:  0.59306216
Average validation F1 score with learning post-processing allow shift:  0.6618931
Average validation precision with learning post-processing:  0.5171063
Average validation precision with learning post-processing allow shift:  0.5799097
Average validation recall with learning post-processing:  0.7292753
Average validation recall with learning post-processing allow shift:  0.81131977
Stage 3, epoch 9, step: 5400, loss_u: 0.6869390606880188, loss_a: 0.3756854236125946, loss: 1.062624454498291
Average training F1 score:  0.6605413060284437
Stage 3, epoch 9, step: 5500, loss_u: 0.6848132014274597, loss_a: 0.3830149173736572, loss: 1.0678281784057617
Average training F1 score:  0.6484041230994917
Stage 3, epoch 9, step: 5600, loss_u: 0.6861662864685059, loss_a: 0.3798011243343353, loss: 1.0659674406051636
Average training F1 score:  0.6662867110928345
Stage 3, epoch 9, step: 5700, loss_u: 0.6858148574829102, loss_a: 0.40550652146339417, loss: 1.091321349143982
Average training F1 score:  0.6411035500903514
Stage 3, epoch 9, step: 5800, loss_u: 0.6755384802818298, loss_a: 0.5790517330169678, loss: 1.2545902729034424
Average training F1 score:  0.4503397609990311
Stage 3, epoch 9, step: 5900, loss_u: 0.6862497329711914, loss_a: 0.5153486132621765, loss: 1.2015984058380127
Average training F1 score:  0.5209117496286991
Average validation F1 score with learning post-processing:  0.5820185
Average validation F1 score with learning post-processing allow shift:  0.63197184
Average validation precision with learning post-processing:  0.47573572
Average validation precision with learning post-processing allow shift:  0.5188924
Average validation recall with learning post-processing:  0.7929315
Average validation recall with learning post-processing allow shift:  0.8585315
Average testing F1 score with learning post-processing:  0.58680165
Average testing F1 score with learning post-processing allow shift:  0.6345162
Average testing precision with learning post-processing:  0.477385
Average testing precision with learning post-processing allow shift:  0.51896024
Average testing recall with learning post-processing:  0.80427396
Average testing recall with learning post-processing allow shift:  0.86912966
